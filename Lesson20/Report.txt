1.	Покажите всех менеджеров, которые имеют в подчинении больше 6-ти сотрудников.

		SELECT T1.MANAGER_ID, T2.FIRST_NAME, T2.LAST_NAME
		FROM EMPLOYEES T1
		JOIN EMPLOYEES T2 ON T1.MANAGER_ID = T2.EMPLOYEE_ID
		GROUP BY T1.MANAGER_ID, T2.FIRST_NAME, T2.LAST_NAME
		HAVING COUNT(T1.EMPLOYEE_ID)>6
		
		
2.	Вывести min и max зарплату с вычетом commission_pct для каждого департамента. 
(commission_pct на базе указывается в процентах). 		

		SELECT T1.DEPARTMENT_ID, T2.DEPARTMENT_NAME
			,MIN(T1.SALARY*(1-T1.COMISSION_PCT)) AS MIN_SALARY
			,MAX(T1.SALARY*(1-T1.COMISSION_PCT)) AS MAX_SALARY

		FROM EMPLOYEES T1
		JOIN DEPARTMENTS T2 ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID
		GROUP BY T1.DEPARTMENT_ID, T2.DEPARTMENT_NAME
		
		
3.	Вывести только регион, где работают больше всего людей.

		SELECT TOP 1 WITH TIES T1.REGION_NAME
		FROM REGIONS T1
		JOIN COUNTRIES T2 ON T1.REGION_ID = T2.REGION_ID
		JOIN LOCATIONS T3 ON T2.COUNTRY_ID = T3.COUNTRY_ID
		JOIN DEPARTMENTS T4 ON T3.LOCATION_ID = T4.LOCATION_ID
		JOIN EMPLOYEES T5 ON T4.DEPARTMENT_ID = T5.DEPARTMENT_ID
		GROUP BY T1.REGION_NAME
		ORDER BY COUNT(T5.EMPLOYEE_ID) DESC		
		
		
4.	Найдите разницу в процентах между средней зп по каждому департаменту от общей средней (по всем департаментам).		

		SELECT DISTINCT T1.DEPARTMENT_ID, T2.DEPARTMENT_NAME
			,(AVG(T1.SALARY2) OVER (PARTITION BY T1.DEPARTMENT_ID)) / (AVG(T1.SALARY2) OVER ()) - 1 AS PCNT

		FROM EMPLOYEES T1
		JOIN DEPARTMENTS T2 ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID
		
		
5. 	Найдите людей, кто проработал больше, чем 10 лет в одном департаменте.	

		SELECT T2.EMPLOYEE_ID, T3.FIRST_NAME, T3.LAST_NAME
		FROM (
		SELECT T1.EMPLOYEE_ID, T1.DEPARTMENT_ID
				,ROUND(SUM(DATEDIFF(DAY,T1.START_DATE,ISNULL(T1.END_DATE,GETDATE())))/365,0) AS YRD
		FROM JOB_HISTORY T1
		GROUP BY T1.EMPLOYEE_ID, T1.DEPARTMENT_ID
		) T2
		JOIN EMPLOYEES T3 ON T2.EMPLOYEE_ID = T3.EMPLOYEE_ID
		WHERE T2.YRD>10
		GROUP BY T2.EMPLOYEE_ID, T3.FIRST_NAME, T3.LAST_NAME
		
		
6.	Найдите людей, кто занимает 5-10 место по размеру зарплаты.  		

		SELECT * FROM (
		SELECT T1.EMPLOYEE_ID, T1.FIRST_NAME, T1.LAST_NAME
				,DENSE_RANK() OVER(ORDER BY SALARY DESC) AS RN
		FROM EMPLOYEES T1
		) T2 
		WHERE RN BETWEEN 5 AND 10